cmake_minimum_required(VERSION 3.10)      # ���� 3.10 �� CMake ��֧���Զ��� Qt ѡ��

# ����������������������������������������������������������������������������������
# 1. ָ�� vcpkg toolchain  (�������·����ȷ)
# ����������������������������������������������������������������������������������
set(CMAKE_TOOLCHAIN_FILE
    "${CMAKE_CURRENT_SOURCE_DIR}/../thirdparty_install/vcpkg/scripts/buildsystems/vcpkg.cmake"
    CACHE STRING "")                       # �� CACHE �ɱ������ configure ʱ�����

# ����������������������������������������������������������������������������������
# 2. ��Ŀ�����ĳ� flowdraw����Ĭ��Ŀ¼���Ѻã�
# ����������������������������������������������������������������������������������
project(flowdraw LANGUAGES CXX)

# ����������������������������������������������������������������������������������
# 3. ȫ�� C++ �汾������ 17��
# ����������������������������������������������������������������������������������
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# ����������������������������������������������������������������������������������
# 4. Windows SDK �汾��������ɾ��
# ����������������������������������������������������������������������������������
if (WIN32)
    set(CMAKE_SYSTEM_VERSION "10.0.18362.0")
endif()

# ����������������������������������������������������������������������������������
# 5. ��ִ���ļ�ͳһ����� build/bin
# ����������������������������������������������������������������������������������
set(EXECUTABLE_OUTPUT_PATH "${CMAKE_BINARY_DIR}/bin")

# ����������������������������������������������������������������������������������
# 6. �Զ��ݹ�������Ŀ¼�����ų�����/����Ŀ¼
#    �� ��֮������Դ����Ŀ¼(�� app, core, gui) ֻ�轨�ļ���+�� CMakeLists
#    �� ��������Զ�ɨ�裬������д add_subdirectory
# ����������������������������������������������������������������������������������
set(EXCLUDE_DIRS ".git" "thirdparty_install" "build")
file(GLOB ALL_ITEMS RELATIVE ${CMAKE_SOURCE_DIR} ${CMAKE_SOURCE_DIR}/*)

foreach(ITEM ${ALL_ITEMS})
    if (IS_DIRECTORY "${CMAKE_SOURCE_DIR}/${ITEM}")
        list(FIND EXCLUDE_DIRS "${ITEM}" IDX)
        if (IDX EQUAL -1)
            add_subdirectory("${ITEM}")
        endif()
    endif()
endforeach()

# ����������������������������������������������������������������������������������
# 7. VS ������Ŀ ���� ָ���������ִ�� (�ĳ� app �� FlowDraw)
# ����������������������������������������������������������������������������������
set_property(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}
             PROPERTY VS_STARTUP_PROJECT app)   # �� ����Ŀ¼ project() ������һ��
